services:
  gateway:
    image: ${REGISTRY}/mycrocloud-gateway:${TAG}
    env_file:
      - ./gateway/.env
    volumes:
      - ./gateway/appsettings.json:/app/appsettings.json:ro
      - /var/run/docker.sock:/var/run/docker.sock
      - /srv/function-data:/srv/function-data
    restart: unless-stopped

  spa-worker:
    image: ${REGISTRY}/mycrocloud-deployment-worker:${TAG}
    env_file:
      - ./spa/worker/.env
    volumes:
      - ./spa/worker/.conf:/app/.conf:ro
      - /var/run/docker.sock:/var/run/docker.sock
      - /tmp/build-outputs:/tmp/build-outputs
    restart: unless-stopped