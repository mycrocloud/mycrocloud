@using MockServer.Web.Controllers.Api
@model MockServer.Web.Models.WebApplications.Routes.RoutePageModel
@{
    ViewData["Title"] = Model.WebApplication.Name;
}
@section Scripts {
<script src="lib/vue/vue.global.js"></script>
<script src="lib/vue/vee-validate.min.js"></script>
<script src="lib/axios/axios.min.js"></script>
}
<style>
    .context-menu {
        position: absolute;
        width: 60px;
    }
</style>
<div class="row">
    <div class="col-2">
        <partial name="/Views/WebApplications/_SideBar.cshtml" model="Model.WebApplication">
    </div>
    <div id="app" class="col-10">
        <div class="row">
            <div class="col-3">
                <div class="d-flex mt-1">
                    <input v-model="searchTerm" @@keyup="delayedSearch" class="form-control form-control-sm me-1"
                        type="text" placeholder="Search">
                    <button @@click="newRoute" class="btn btn-sm bg-violet-500 text-white">
                        <i class="bi bi-plus"></i>
                    </button>
                </div>
                <div class="route-list-container">
                    <route-list :routes="routes" @@click-route="openRoute"
                        @@route-deleted="onRouteDeleted"></route-list>
                </div>
            </div>
            <div class="col-9">
                <div v-if="openingRoute" style="overflow-y: scroll">
                    <form v-on:submit.prevent="onSubmit">
                        <div class="card mt-1">
                            <div class="card-header">
                                Request
                            </div>
                            <div class="card-body">
                                <div>
                                    <small>Name</small>
                                    <input type="text" v-model="openingRoute.name" class="form-control form-control-sm"
                                        aria-autocomplete="none">
                                </div>
                                <div class="mt-1 d-flex">
                                    <div>
                                        <small>Method</small>
                                        <select v-model="openingRoute.method"
                                            class="form-select form-select-sm w-auto me-2">
                                            @foreach (var method in Model.HttpMethodSelectListItem)
                                            {
                                                    <option value="@method.Value">@method.Text</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="flex-fill">
                                        <small>Path</small>
                                        <input type="text" v-model="openingRoute.path"
                                            class="form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="mt-1">
                                    <small>Url</small>
                                    <div class="input-group input-group-sm">
                                        <input type="text" class="form-control"
                                            :value="openingRoute.method + ' ' + '@(string.Format("https://wa-{0}.mockserver.com", Model.WebApplication.WebApplicationId.ToString("D10")))' + '/' + openingRoute.path"
                                            readonly>
                                        <button type="button" class="input-group-text ">
                                            <i class="bi bi-clipboard"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <a class="text-decoration-none" data-bs-toggle="collapse"
                                        href="#requestAuthorization" role="button">
                                        Authorization
                                    </a>
                                    <div class="collapse" id="requestAuthorization">
                                        <div class="card card-body">
                                            <div>
                                                <small>Authorization Type</small>
                                                <div class="mt-1">
                                                    @foreach (var type in Model.AuthorizationTypeSelectListItem)
                                                    {
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="radio" value="@type.Value"
                                                            v-model="openingRoute.authorization.type"
                                                            @@change="onRouteAuthorizationTypeChanged">
                                                                <label class="form-check-label">@type.Text</label>
                                                            </div>
                                                    }
                                                </div>
                                            </div>
                                            <div v-show="openingRoute.authorization.type == 2" class="mt-1">
                                                <small>Policy</small>
                                                <select class="form-select"
                                                    v-model="openingRoute.authorization.policies" multiple="multiple"
                                                    data-placeholder="Select policies...">
                                                    @foreach (var policy in Model.AuthorizationPolicySelectListItem)
                                                    {
                                                            <option value="@policy.Value">@policy.Text</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#requestValidation"
                                        role="button">
                                        Request Validation
                                    </a>
                                    <div class="collapse" id="requestValidation">
                                        <ul class="nav nav-tabs" role="tablist">
                                            <li class="nav-item" role="presentation">
                                                <button type="button" class="nav-link active py-1" data-bs-toggle="tab"
                                                    data-bs-target="#request-param-tab">Query</button>
                                            </li>
                                            <li class="nav-item">
                                                <button type="button" class="nav-link py-1" data-bs-toggle="tab"
                                                    data-bs-target="#request-header-tab">Headers</button>
                                            </li>
                                            <li class="nav-item">
                                                <button type="button" class="nav-link py-1" data-bs-toggle="tab"
                                                    data-bs-target="#request-body-tab">Body</button>
                                            </li>
                                        </ul>
                                        <div class="tab-content" style="min-height: 200px;">
                                            <div id="request-param-tab" class="tab-pane show active p-2"
                                                role="tabpanel">
                                                <table class="table table-sm p-0 m-0">
                                                    <thead>
                                                        <tr>
                                                            <th style="width: 20%" scope="col">Key</th>
                                                            <th style="width: 75%" scope="col">Attributes</th>
                                                            <th style="width: 5%" scope="col">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(query, index) in openingRoute.requestQueries">
                                                            <td class="align-middle">
                                                                <input type="text" v-model="query.key"
                                                                    class="form-control form-control-sm"
                                                                    placeholder="key" autocomplete="off">
                                                            </td>
                                                            <td class="align-middle">
                                                                <div class="d-flex">
                                                                    <select style="display: none;"
                                                                        v-model="query.attributes" multiple></select>
                                                                    <div class="d-flex">
                                                                        <span v-for="attr in query.attributes"
                                                                            class="me-1 bg-gray py-1 px-2 rounded">{{attr.name}}</span>
                                                                    </div>
                                                                    <button type="button" class="ms-auto"
                                                                        v-on:click="showValidationAttributesModal(query.attributes, attrs => query.attributes = attrs)">
                                                                        <i class="bi bi-box-arrow-in-up-right"></i>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td class="align-middle">
                                                                <button type="button"
                                                                    class="btn text-gray btn-show-on-hover"
                                                                    v-on:click="openingRoute.requestQueries.splice(index, 1)">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="mt-1">
                                                    <button type="button" class="btn btn-secondary btn-sm"
                                                        v-on:click="addRow('requestQueries')">Add</button>
                                                </div>
                                            </div>
                                            <div id="request-header-tab" class="tab-pane p-2" role="tabpanel">
                                                <table id="request-header-table" class="table table-sm p-0 m-0">
                                                    <thead>
                                                        <tr>
                                                            <th style="width: 20%" scope="col">Header</th>
                                                            <th style="width: 75%" scope="col">Attributes</th>
                                                            <th style="width: 5%" scope="col">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="(header, index) in openingRoute.requestHeaders">
                                                            <td class="align-middle">
                                                                <input type="text" v-model="header.name"
                                                                    class="form-control form-control-sm"
                                                                    placeholder="name" autocomplete="off"
                                                                    aria-autocomplete="none">
                                                            </td>
                                                            <td class="align-middle">
                                                                <div class="d-flex">
                                                                    <select style="display: none;"
                                                                        v-model="header.attributes" multiple></select>
                                                                    <div class="d-flex">
                                                                        <span v-for="attr in header.attributes"
                                                                            class="me-1 bg-gray py-1 px-2 rounded">{{attr.name}}</span>
                                                                    </div>
                                                                    <button type="button" class="ms-auto"
                                                                        v-on:click="showValidationAttributesModal(header.attributes, attrs => header.attributes = attrs)">
                                                                        <i class="bi bi-box-arrow-in-up-right"></i>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td class="align-middle">
                                                                <button type="button"
                                                                    class="btn text-gray btn-show-on-hover"
                                                                    v-on:click="openingRoute.requestHeaders.splice(index, 1)">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="mt-1">
                                                    <button type="button" class="btn btn-secondary btn-sm"
                                                        v-on:click="addRow('requestHeaders')">Add</button>
                                                </div>
                                            </div>
                                            <div id="request-body-tab" class="tab-pane p-2" role="tabpanel">
                                                <div class="mt-1">
                                                    <div class="card mt-2">
                                                        <div class="card-header">
                                                            Fields Validation
                                                        </div>
                                                        <div class="card-body">
                                                            <div>
                                                                <p class="form-text">To refer to the entire body object,
                                                                    enter a
                                                                    period (.) in the field name, and to refer to a
                                                                    specific
                                                                    field
                                                                    of the body object, simply enter the field name in
                                                                    without
                                                                    the period prefix.</p>
                                                            </div>
                                                            <table class="table table-sm">
                                                                <thead>
                                                                    <tr>
                                                                        <th style="width: 20%" scope="col">Field</th>
                                                                        <th style="width: 75%" scope="col">Attributes
                                                                        </th>
                                                                        <th style="width: 5%" scope="col">Actions</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr
                                                                        v-for="(field, index) in openingRoute.requestBody.fieldValidationAttributes">
                                                                        <td class="align-middle">
                                                                            <input type="text" v-model="field.name"
                                                                                class="form-control form-control-sm"
                                                                                placeholder="name" autocomplete="off"
                                                                                aria-autocomplete="none">
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            <div class="d-flex">
                                                                                <select style="display: none;"
                                                                                    v-model="field.attributes"
                                                                                    multiple></select>
                                                                                <div class="d-flex">
                                                                                    <span
                                                                                        v-for="attr in field.attributes"
                                                                                        class="me-1 bg-gray py-1 px-2 rounded">{{attr.name}}</span>
                                                                                </div>
                                                                                <button type="button" class="ms-auto"
                                                                                    v-on:click="showValidationAttributesModal(field.attributes, attrs => field.attributes = attrs)">
                                                                                    <i
                                                                                        class="bi bi-box-arrow-in-up-right"></i>
                                                                                </button>
                                                                            </div>
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            <button type="button"
                                                                                class="btn text-gray btn-show-on-hover"
                                                                                v-on:click="openingRoute.requestBody.fieldValidationAttributes.splice(index, 1)">
                                                                                <i class="bi bi-trash"></i>
                                                                            </button>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <div class="mt-1">
                                                                <button type="button" class="btn btn-secondary btn-sm"
                                                                    v-on:click="addRequesBodyField">Add</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <validation-attributes-modal v-if="validationAttributesModalVisible"
                                :attributes="validationAttributesModalAttributes"
                                @@save="onValidationAttributesModalSaved"
                                @@close="closeValidationAttributesModal"></validation-attributes-modal>
                        </div>
                        <div class="card mt-1">
                            <div class="card-header">
                                Response
                            </div>
                            <div class="card-body">
                                <small>Response Provider</small>
                                <div class="mt-1">
                                    @foreach (var type in Model.ResponseProviderSelectListItem)
                                    {
                                        <div class="form-check form-check-inline">
                                            <input v-model="openingRoute.integrationType" class="form-check-input"
                                            type="radio" value="@type.Value">
                                            <label class="form-check-label">@type.Text</label>
                                        </div>
                                    }
                                </div>
                                
                            </div>
                        </div>
                        <div class="mt-1 d-flex">
                            <button type="button" @@click="discardChange"
                                class="btn btn-secondary ms-auto">Cancle</button>
                            <button type="submit" class="btn btn-primary ms-2">Save</button>
                        </div>
                    </form>
                </div>
                <div v-else>
                    Click to show details
                </div>
            </div>
        </div>
    </div>
</div>
<template id="route-list-template">
    <ul v-if="routes.length > 0" class="list-group list-group-flush mt-2">
        <li v-for="route in routes" :key="route.id" class="list-group-item px-2 py-1"
            :class="{'bg-gray': route.id === selected_id}">
            <div class="row">
                <div v-on:click="click(route.id)" class="col" style="position: relative;">
                    <a onclick="event.preventDefault()" href="#"
                        class="text-decoration-none stretched-link">{{route.name}}</a>
                    <div>
                        <small class="badge rounded-pill me-1" style="width: 60px;"
                            :class="getMethodClass(route.method)">{{route.method}}</small>
                        <small class="text-muted">/{{route.path}}</small>
                    </div>
                </div>
                <div class="p-0 my-auto" style="width: 40px;">
                    <button v-on:click="showActionsMenu(route.id, $event)" class="btn btn-sm" type="button">
                        <i class="bi bi-three-dots"></i>
                    </button>
                </div>
            </div>
        </li>
    </ul>
    <div v-if="itemActionsMenuVisible" class="btn-group-vertical dropdown-menu context-menu" role="group">
        <button type="button" v-on:click="showDeleteConfirmModal"
            class="dropdown-item btn btn-default text-danger">Delete</button>
    </div>
    <div v-if="routeDeleteConfirmModalVisible" class="modal" :id="routeDeleteConfirmModalId" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Delete confirm</h5>
                    <button type="button" class="btn-close" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are your sure want to delete route?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger"
                        v-on:click="deleteRoute(itemActionsMenuClickedRouteId)">Delete</button>
                </div>
            </div>
        </div>
    </div>
</template>
<template id="validation-attributes-modal-template">
    <div id="validationAttributesModal" class="modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title">Validation Attributes</h6>
                    <button type="button" class="btn-close" v-on:click="close"></button>
                </div>
                <div class="modal-body">
                    <ul class="list-group list-group-flush">
                        <li v-for="(attr, index) in attrs" class="list-group-item">
                            <div class="d-flex">
                                <select v-model="attr.name" class="form-select form-select-sm w-auto me-1">
                                    <option :value="null" selected>Attribute Name</option>
                                    <option v-for="item in builtInValdationAttributes" :value="item.name">
                                        {{item.name}}
                                    </option>
                                </select>
                                <input type="text" v-model="attr.parameters" class="form-control form-control-sm"
                                    :placeholder="computeParametersPlaceholder(attr)" />
                                <button type="button" class="btn text-gray btn-show-on-hover" @@click="remove(index)">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </li>
                    </ul>
                    <div class="mt-2">
                        <button type="button" class="btn btn-secondary btn-sm" @@click="add">Add</button>
                    </div>
                </div>
                <div class="modal-footer p-2">
                    <button type="button" class="btn btn-secondary" v-on:click="close">Cancel</button>
                    <button type="button" class="btn btn-primary" v-on:click="save">Save</button>
                </div>
            </div>
        </div>
    </div>
</template>
<script>
    const ValidationAttributesModal = {
        template: '#validation-attributes-modal-template',
        props: {
            attributes: {
                type: Object,
                default: () => ({})
            }
        },
        methods: {
            close() {
                this.$emit('close')
            },
            save() {
                //TODO: Validation here
                this.$emit('save', this.attrs)
            },
            add() {
                this.attrs.push({ name: null, parameters: '' });
            },
            remove(index) {
                this.attrs.splice(index, 1)
            }
        },
        data: function () {
            const attrs = JSON.parse(JSON.stringify(this.attributes || []));
            return {
                attrs: attrs,
                builtInValdationAttributes: JSON.parse('@Html.Raw(Json.Serialize(Model.BuiltInValdationAttributes))')
            }
        },
        computed: {
            computeParametersPlaceholder() {
                return (attr) => {
                    const selectedOption = this.builtInValdationAttributes.find(item => item.name === attr.name)
                    return selectedOption ? selectedOption.parameterDescription : 'Attribute parameters'
                }
            }
        }
    }
    const RouteList = {
        props: {
            routes: {
                type: Array,
                required: true
            }
        },
        template: '#route-list-template',
        methods: {
            click(id) {
                this.selected_id = id
                this.$emit('click-route', id);
            },
            editRoute(route) {
                this.$emit('edit-route', route);
            },
            createRoute() {
                this.$emit('create-route');
            },
            getMethodClass(method) {
                switch (method) {
                    case 'DELETE': return 'text-red';
                    case 'POST': return 'text-orange';
                    case 'PUT': return 'text-yellow';
                    case 'GET': return 'text-green';
                    default: return 'text-blue';
                }
            },
            showActionsMenu(id, event) {
                this.itemActionsMenuClickedRouteId = id
                this.itemActionsMenuVisible = true
            },
            async showDeleteConfirmModal(id) {
                this.routeDeleteConfirmModalVisible = true
                await nextTick()
                const modalEl = document.getElementById(this.routeDeleteConfirmModalId)
                let modal = new bootstrap.Modal(modalEl, {})
                modalEl.addEventListener('hidden.bs.modal', function (event) {
                    modal.dispose()
                    this.routeDeleteConfirmModalVisible = false
                })
                modal.show()
            },
            deleteRoute(id) {
                const DeleteUrl = '@Url.Action(nameof(WebApplicationRoutesApiController.Delete), "WebApplicationRoutesApi", new {WebApplicationName = Model.WebApplication.Name})'
                axios.post(DeleteUrl.trimEnd('?') + `?RouteId=${id}`)
                    .then(res => this.$emit('route-deleted', id))
                    .then(async () => {
                        let modal = bootstrap.Modal.getInstance(document.getElementById(this.routeDeleteConfirmModalId), {})
                        modal.dispose()
                        this.routeDeleteConfirmModalVisible = false
                    });
            }
        },
        data: function () {
            return {
                selected_id: null,
                itemActionsMenuVisible: false,
                itemActionsMenuClickedRouteId: null,
                routeDeleteConfirmModalVisible: false,
                routeDeleteConfirmModalId: 'routeDeleteConfirmModal'
            }
        }
    }

    let timeout = null;
    const { createApp, onMounted, ref, nextTick } = Vue
    const app = createApp({
        setup() {
            const webapp = ref(null);
            const routes = ref([]);
            const openingRoute = ref(null);
            let openingRouteOriginalValue = null;
            const mode = ref();
            const openingRouteId = ref(0);
            const searchTerm = ref('');
            const RouteBaseUrl = '@string.Format("https://wa-{0}.mockserver.com", Model.WebApplication.WebApplicationId)';
            const openRoute = async id => {
                if (mode.value !== 'EDIT') {
                    mode.value = 'EDIT';
                }
                let tempUrl = '@Url.Action(nameof(WebApplicationRoutesApiController.Get),"WebApplicationRoutesApi", new { WebApplicationName = Model.WebApplication.Name, RouteId = -9999})';
                axios.get(tempUrl.replace('-9999', id))
                    .then(res => {
                        openingRoute.value = res.data
                        openingRoute.value.requestBody = openingRoute.value.requestBody || {}
                        this.openingRouteOriginalValue = JSON.parse(JSON.stringify(openingRoute.value));
                        openingRouteId.value = id
                    })
            }
            const delayedSearch = () => {
                const IndexUrl = '@Url.Action(nameof(WebApplicationRoutesApiController.List), "WebApplicationRoutesApi", new {WebApplicationName = Model.WebApplication.Name})'
                clearTimeout(timeout);
                timeout = setTimeout(async () => {
                    const params = {
                        SearchTerm: searchTerm.value
                    }
                    const query_params = new URLSearchParams(params);
                    let reqOptions = {
                        method: "GET",
                        url: IndexUrl.trimEnd('?') + '?' + query_params.toString()
                    }
                    let response = await axios.request(reqOptions);
                    routes.value = response.data
                }, 800);
            }

            const newRoute = () => {
                mode.value = 'CREATE';
                openingRoute.value = {
                    id: 0,
                    name: 'untitled',
                    method: 'GET',
                    path: '',
                    integrationType: 1,
                    authorization: {
                        type: 0,
                        policies: []
                    },
                    requestBody: {}
                }
                routes.value.unshift(openingRoute.value)
                openingRouteId.value = 0
            }
            const onSubmit = () => {
                let url = ''
                if (mode.value === 'CREATE') {
                    url = '@Url.Action(nameof(WebApplicationRoutesApiController.Create), "WebApplicationRoutesApi", new { WebApplicationName = Model.WebApplication.Name})'
                } else {
                    let tempUrl = '@Url.Action(nameof(WebApplicationRoutesApiController.Edit), "WebApplicationRoutesApi", new { WebApplicationName = Model.WebApplication.Name, RouteId = -9999})'
                    url = tempUrl.replace('-9999', openingRoute.value.id);
                }
                axios.post(url, openingRoute.value)
                    .then(res => {
                        console.log(JSON.stringify(res.data))
                        if (mode.value === 'CREATE') {
                            openingRoute.value.id = res.data
                            openingRouteId.value = res.data
                        }
                    })
                    .catch(err => console.log(err));
            }
            const discardChange = () => {
                if (mode.value === 'EDIT') {
                    openingRoute.value = this.openingRouteOriginalValue
                    this.openingRouteOriginalValue = JSON.parse(JSON.stringify(openingRoute.value))
                } else {
                    //CREATE
                    routes.value.splice(0, 1)
                    openingRoute.value = null
                    openingRouteId.value = null
                }
            }
            const addRow = (prop) => {
                openingRoute.value[prop] = openingRoute.value[prop] || [];
                openingRoute.value[prop].push({
                    name: null,
                    attributes: []
                });
            }
            const addRequesBodyField = () => {
                openingRoute.value.requestBody.fieldValidationAttributes = openingRoute.value.requestBody.fieldValidationAttributes || []
                openingRoute.value.requestBody.fieldValidationAttributes.push({ name: null, attributes: [] })
            }

            let validationAttributesModalObj = null;
            const validationAttributesModalVisible = ref(false)
            const validationAttributesModalAttributes = ref(null)
            let onValidationAttributesModalSavedHandler
            const showValidationAttributesModal = async (attributes, onValidationAttributesModalSavedHandler) => {
                validationAttributesModalAttributes.value = attributes
                this.onValidationAttributesModalSavedHandler = onValidationAttributesModalSavedHandler
                validationAttributesModalVisible.value = true
                await nextTick()
                this.validationAttributesModalObj = new bootstrap.Modal(document.getElementById("validationAttributesModal"), {})
                this.validationAttributesModalObj.show()
            }
            const closeValidationAttributesModal = () => {
                this.validationAttributesModalObj.hide()
                this.validationAttributesModalObj = null
                validationAttributesModalVisible.value = false
                this.onValidationAttributesModalSavedHandler = null
            }
            const onValidationAttributesModalSaved = (attributes) => {
                this.onValidationAttributesModalSavedHandler(attributes)

                this.validationAttributesModalObj.hide()
                this.validationAttributesModalObj = null
                validationAttributesModalVisible.value = false
                this.onValidationAttributesModalSavedHandler = null
            }
            const onRouteDeleted = (id) => {
                const index = routes.value.findIndex(r => r.id === id);
                if (index > -1) {
                    if (openingRouteId === id) {
                        openRoute.value = null
                    }
                    routes.value.splice(index, 1)
                }
            }
            onMounted(() => {
                webapp.value = JSON.parse('@Html.Raw(Json.Serialize(Model.WebApplication))')
                routes.value = JSON.parse('@Html.Raw(Json.Serialize(Model.Routes.Select(r => new {
                    Id = r.RouteId,
                    r.Name,
                    r.Method,
                    r.Path
                    })))')
            })

            const onRouteAuthorizationTypeChanged = () => {
                if (openingRoute.value.authorization.type === 0 || openingRoute.value.authorization.type) {

                }
            }
            return {
                routes,
                RouteBaseUrl,
                openingRoute,
                openingRouteId,
                openRoute,
                newRoute,
                delayedSearch,
                searchTerm,
                webapp,
                onSubmit,
                discardChange,
                mode,
                onRouteDeleted,
                addRow,
                addRequesBodyField,
                validationAttributesModalVisible,
                validationAttributesModalAttributes,
                showValidationAttributesModal,
                onValidationAttributesModalSaved,
                closeValidationAttributesModal,
                onRouteAuthorizationTypeChanged
            }
        }
    });
    app.component('route-list', RouteList)
    app.component('validation-attributes-modal', ValidationAttributesModal)
    app.use(VeeValidate)
    app.mount('#app')
</script>
